<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="icon" type="image/x-icon" href="favicon.ico">
    <title>Email Security Tools</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@400;600&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>
<body class="dark">
    <div class="container">
        <!-- Header with theme toggle and tabs -->
        <header class="header">
            <div class="tabs-container">
                <button class="tab-button active" data-tab="dns">üîç DNS Check</button>
                <button class="tab-button" data-tab="header">üìß Header Check</button>
            </div>
            <div class="header-actions">
                <button id="learnBtn" class="learn-button" aria-label="Learn about email security">üìö Learn</button>
                <button id="themeToggle" class="theme-toggle" aria-label="Toggle dark/light mode">‚òÄÔ∏è</button>
            </div>
        </header>

        <!-- DNS Check Tab -->
        <main class="main-content dns-content" id="dns-tab">
            <!-- Logo/Title -->
            <div class="logo-section">
                <h1>- DNS Check -</h1>
                <p>Check your SPF, DMARC, DKIM and MX records now</p>
            </div>

            <!-- Search section -->
            <div class="search-section">
                <div class="search-container">
                    <div class="search-box">
                        <input type="text" id="domain" placeholder="Enter your domain (e.g., checkjedns.nl)" autocomplete="off">
                        <button id="checkButton" class="search-button" aria-label="Check domain">
                            <svg width="20" height="20" viewBox="0 0 24 24" fill="none" xmlns="http://www.w3.org/2000/svg">
                                <path d="M21 21L16.514 16.506L21 21ZM19 10.5C19 15.194 15.194 19 10.5 19C5.806 19 2 15.194 2 10.5C2 5.806 5.806 2 10.5 2C15.194 2 19 5.806 19 10.5Z" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"/>
                            </svg>
                        </button>
                    </div>
                </div>
            </div>

            <!-- Quick action buttons -->
            <div class="quick-actions">
                <div class="action-button">
                    <div class="action-icon">üá≥üá±</div>
                    <span>Dutch Records</span>
                </div>
                <div class="action-button">
                    <div class="action-icon">üîç</div>
                    <span>200+ Checks</span>
                </div>
                <div class="action-button">
                    <div class="action-icon">‚ö°</div>
                    <span>Fast Results</span>
                </div>
            </div>
        </main>

        <!-- Email Header Check Tab -->
        <main class="main-content header-content" id="header-tab" style="display: none;">
            <!-- Logo/Title -->
            <div class="logo-section">
                <h1> - Header Check - </h1>
                <p>Analyze SPF, DKIM and DMARC instantly</p>
            </div>

            <!-- Input method selector -->
            <div class="input-method-selector">
                <button class="method-toggle active" id="eml-toggle" data-method="eml" aria-label="Upload EML file">Upload .eml File</button>
                <button class="method-toggle" data-method="paste" aria-label="Paste headers">Paste Headers</button>
            </div>

            <!-- Hidden input for drag and drop and file picker -->
            <input id="file-input" type="file" accept=".eml" hidden>

            <!-- Paste headers section (hidden by default) -->
            <div class="input-card method-section" id="paste-section" data-method="paste" style="display: none;">
                <textarea id="header-input" placeholder="Paste full email headers here (From the email source)" class="header-textarea"></textarea>
            </div>

            <!-- Quick action buttons -->
            <div class="quick-actions">
                <div class="action-button">
                    <div class="action-icon">üîç</div>
                    <span>Analyze Headers</span>
                </div>
                <div class="action-button">
                    <div class="action-icon">üîó</div>
                    <span>Check Links</span>
                </div>
                <div class="action-button">
                    <div class="action-icon">‚ö°</div>
                    <span>Fast Results</span>
                </div>
            </div>
        </main>

        <!-- Copyright -->
        <footer class="copyright">
            <a class="footer-github" href="https://github.com/notfocust/Checkjedns/tree/main" target="_blank" rel="noopener noreferrer" aria-label="View GitHub repositories">
                <!-- GitHub Mark (filled) SVG -->
                <svg height="20" viewBox="0 0 16 16" width="20" aria-hidden="true" fill="currentColor" xmlns="http://www.w3.org/2000/svg">
                    <path fill-rule="evenodd" d="M8 0C3.58 0 0 3.58 0 8c0 3.54 2.29 6.53 5.47 7.59.4.07.55-.17.55-.38 0-.19-.01-.82-.01-1.49-2.01.37-2.53-.49-2.69-.94-.09-.23-.48-.94-.82-1.13-.28-.15-.68-.52-.01-.53.63-.01 1.08.58 1.23.82.72 1.21 1.87.87 2.33.66.07-.52.28-.87.51-1.07-1.78-.2-3.64-.89-3.64-3.95 0-.87.31-1.59.82-2.15-.08-.2-.36-1.02.08-2.12 0 0 .67-.21 2.2.82.64-.18 1.32-.27 2-.27.68 0 1.36.09 2 .27 1.53-1.04 2.2-.82 2.2-.82.44 1.1.16 1.92.08 2.12.51.56.82 1.27.82 2.15 0 3.07-1.87 3.75-3.65 3.95.29.25.54.73.54 1.48 0 1.07-.01 1.93-.01 2.2 0 .21.15.46.55.38C13.71 14.53 16 11.54 16 8c0-4.42-3.58-8-8-8z"></path>
                </svg>
            </a>
        </footer>
    </div>
    
    <!-- DNS Results Modal -->
    <div id="resultsModal" class="modal" aria-hidden="true" role="dialog" aria-modal="true">
        <div class="modal-content">
            <button class="modal-close" id="modalClose" aria-label="Close">‚úï</button>
            <div class="modal-header">
                <h2 id="modalTitle">Results</h2>
                <div class="modal-controls">
                    <input type="text" id="modalDomain" placeholder="Enter a domain" />
                    <button id="modalCheck" class="btn btn-primary">Check</button>
                    <button id="tipsButton" class="btn tips-btn" aria-label="Toggle email security tips" title="Show email security tips">
                        üí°
                    </button>
                </div>
            </div>
            <div class="modal-body">
                <div id="modalResults"></div>
            </div>
        </div>
    </div>

    <!-- Header Results Modal -->
    <div id="results-modal" class="modal" aria-hidden="true" role="dialog" aria-modal="true">
        <div class="modal-backdrop" data-close="modal"></div>
        <div class="modal-dialog" role="document" aria-labelledby="modal-title">
            <div class="modal-header">
                <h2 id="modal-title">Results</h2>
                <div class="modal-actions">
                    <button id="preview-email-btn" class="button secondary" type="button" aria-label="Preview Email" title="Preview Email">üìß Preview Email</button>
                    <button id="check-links-btn" class="button secondary" type="button" aria-label="Check Links" title="Check Links">üîó Check Links</button>
                    <button class="button ghost modal-close" type="button" aria-label="Close" title="Close" data-close="modal">‚úï</button>
                </div>
            </div>
            <div class="modal-body">
                <section class="results" id="results" hidden>
                    <div class="summary" id="summary"></div>
                    <div class="auth-status" id="auth-status" hidden>
                        <div class="badges" id="auth-badges"></div>
                        <div class="auth-details" id="auth-details"></div>
                    </div>
                    <div class="table-wrap" style="margin-top:12px">
                        <h3 style="margin:10px 12px" id="header-fields-title">Header fields from:</h3>
                        <table id="fields-table" aria-label="Header fields">
                            <thead>
                                <tr>
                                    <th>Field</th>
                                    <th>Value</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                    <div class="table-wrap" style="margin-top:12px">
                        <h3 style="margin:10px 12px">Per-hop delay</h3>
                        <table id="hops-table" aria-label="Per-hop delay">
                            <thead>
                                <tr>
                                    <th>#</th>
                                    <th>From</th>
                                    <th>By</th>
                                    <th>Time UTC</th>
                                    <th>Delay</th>
                                </tr>
                            </thead>
                            <tbody></tbody>
                        </table>
                    </div>
                </section>
            </div>
        </div>
    </div>

    <!-- Learn Modal -->
    <div id="learnModal" class="modal" aria-hidden="true" role="dialog" aria-modal="true">
        <div class="modal-content learn-modal-content">
            <button class="modal-close" id="learnModalClose" aria-label="Close">‚úï</button>
            <div class="modal-header">
                <h2>üìö Learn About Email Security</h2>
            </div>
            <div class="learn-content">
                <div class="learn-section">
                    <h3>üîê SPF (Sender Policy Framework)</h3>
                    <p><strong>What is it?</strong> SPF is a DNS record that tells email servers which servers are authorized to send emails on behalf of your domain.</p>
                    <p><strong>Why it matters:</strong> SPF helps prevent email spoofing and unauthorized use of your domain.</p>
                    <p><strong>How to use:</strong> Add an SPF record to your DNS settings. A basic SPF record looks like: <code>v=spf1 include:_spf.google.com ~all</code></p>
                    <p><strong>Example:</strong> When someone receives an email from you@example.com, their email server checks the SPF record for example.com to verify the sender's server is authorized.</p>
                </div>

                <div class="learn-section">
                    <h3>üîë DKIM (DomainKeys Identified Mail)</h3>
                    <p><strong>What is it?</strong> DKIM uses cryptographic signatures to verify that emails haven't been altered during delivery and that they actually come from your domain.</p>
                    <p><strong>Why it matters:</strong> DKIM proves the authenticity and integrity of your emails, protecting against tampering and forgery.</p>
                    <p><strong>How to use:</strong> Your email provider (Gmail, Office 365, etc.) typically generates DKIM keys for you. Add them to your DNS records.</p>
                    <p><strong>Example:</strong> Each email sent from your domain is signed with a private key. Recipients can verify the signature using the public key in your DNS records.</p>
                </div>

                <div class="learn-section">
                    <h3>üìã DMARC (Domain-based Message Authentication, Reporting and Conformance)</h3>
                    <p><strong>What is it?</strong> DMARC is a policy that combines SPF and DKIM to create a comprehensive authentication strategy and tells servers what to do with failed emails.</p>
                    <p><strong>Why it matters:</strong> DMARC gives you control over your domain's email reputation and helps prevent phishing attacks using your domain.</p>
                    <p><strong>How to use:</strong> Create a DMARC policy in DNS. A basic policy: <code>v=DMARC1; p=quarantine; rua=mailto:admin@example.com</code></p>
                    <p><strong>Policies:</strong></p>
                    <ul class="policy-list">
                        <li><strong>p=none:</strong> Monitor only - no action taken on failures</li>
                        <li><strong>p=quarantine:</strong> Failed emails go to spam folder</li>
                        <li><strong>p=reject:</strong> Failed emails are rejected completely</li>
                    </ul>
                </div>

                <div class="learn-section">
                    <h3>üéØ Best Practices</h3>
                    <ul class="practice-list">
                        <li>Implement all three: SPF, DKIM, and DMARC for maximum protection</li>
                        <li>Start with DMARC p=none to monitor your email infrastructure</li>
                        <li>Gradually move to p=quarantine or p=reject as you feel confident</li>
                        <li>Monitor DMARC reports to identify unauthorized senders</li>
                        <li>Update records when changing email providers</li>
                        <li>Use alignment in DMARC - ensure From address domain matches SPF/DKIM domains</li>
                    </ul>
                </div>
            </div>
        </div>
    </div>

    <script src="script.js"></script>
</body>
</html>
